# 세션 종료 프로토콜 — 상세

> meta-dialogue SKILL.md에서 참조

---

## 폴더 구조

처음 사용할 때 저장 경로 아래에 다음 구조를 생성합니다:

```
{저장 경로}/
├── sessions/                  # 세션 기록 저장 폴더
│   └── _raw/                  # 대화 원문
├── meta-profile.md            # 메타 프로필 (가설, 패턴, 사각지대)
└── about-me.md                # (선택) 사고 원칙, 커리어 맥락
```

`about-me.md`는 필수가 아닙니다. 없으면 첫 세션에서 대화를 통해 맥락을 파악합니다.
있으면 더 빠르게 깊은 대화로 진입할 수 있습니다.

---

## 세션 종료 프로토콜

대화가 마무리되면 다음을 수행합니다:

### 0. 기록 언어 원칙

> **사용자의 말이 제목이 되고, 분석은 부연이다.**

세션 기록의 섹션 제목, 핵심 발견, meta-profile 업데이트 모두에 적용:

| 항목 | 방식 |
|------|------|
| **섹션 제목** | 사용자가 대화 중 실제로 한 말을 그대로 쓴다 |
| **핵심 발견** | 사용자의 말 → 부연 설명 순서. 분석 라벨이 앞에 오지 않는다 |
| **meta-profile 가설** | 내부 인덱싱용 라벨은 유지하되, 설명 첫 줄에 사용자의 실제 표현을 넣는다 |
| **분석적 라벨** | 사용자가 직접 그 이름을 제안한 경우에만 제목으로 사용한다 |

```
❌ "속도의 역설: AI가 빨라지면 더 많이 하지, 덜 하지 않는다"
✅ "빨라졌는데 왜 더 바쁘지?" — AI가 해주니까 빈 시간에 더 넣게 되더라

❌ "### 멈추기의 본질"
✅ "### '차분히 앉아서 정리하는 시간이 필요할 수도'"
```

### 1. 세션 기록 저장
`{저장 경로}/sessions/YYYY-MM-DD-{주제}.md` 형식으로 저장합니다.

#### 세션 기록 2단 구조: 기록 + 구조 메모

세션 기록은 **두 개의 섹션**으로 나뉩니다:

| 섹션 | 톤 | 역할 |
|------|-----|------|
| `## 기록` | 서사 (사용자의 '글' 문체) | 겪은 것을 기억하기 위해 |
| `## 구조 메모` | 분석 (기존 리포트 톤) | 패턴과 연결을 빠르게 찾기 위해 |

**`## 기록` 작성 규칙** — 사용자의 의도적 글쓰기 문체를 따릅니다:

- **서사 → 깨달음 → 다짐** 구조 (월별 요약과 동일)
- 감정에 이름을 붙이고 맥락을 설명 (날것 폭발이 아니라 구조화)
- 자기 객관화를 유지하면서도 1인칭 감정 보존
- 긴 서술 + 짧은 착지 리듬
- 볼드는 핵심 인사이트에만
- 과거형 서술 + 현재형 깨달음 시제 전환
- 위키링크는 문맥 참조로 자연스럽게 삽입
- 참고: `{저장 경로}/4-growth/글쓰기 스타일 분석.md`

**`## 구조 메모` 구성:**

```markdown
## 구조 메모

> 패턴, 연결, 실행을 빠르게 찾기 위한 분석 노트.

### 핵심 발견
- (불릿 리스트)

### 패턴 확인/깨짐
- (기존 패턴 확인, 깨짐, 새 가설)

### 실제로 한 것
- (산출물, 행동)

### 연결
- 이전 세션:
- 관련 주제:
```

**예시**: `{저장 경로}/2-sessions/2026-02-24-daily-anchor.md` (세션 14)를 참고.

### 1.5. 대화 원문 저장

세션 기록(요약)과 별도로, **대화 원문**을 `_raw/` 폴더에 저장합니다.

**저장 경로**: `{저장 경로}/sessions/_raw/YYYY-MM-DD-session{N}-{주제}.md`

#### 원문 포맷 규칙

```markdown
# 세션 {N} 대화 원문

> {날짜} | /meta-dialogue 세션 — {주제 한 줄 요약}

---

**나**: [사용자 발화 원문]

**Claude**: [Claude 발화 원문]

---

**나**: [다음 발화]

**Claude**: [다음 발화]
```

#### 포함/제외 기준

| 포함 | 제외 |
|------|------|
| 사용자의 실제 발화 전체 | 타임스탬프 (시:분) |
| Claude의 실질적 대화 응답 | 시스템 메시지 (`<system-reminder>` 등) |
| 대화 흐름에 영향을 준 도구 동작 → 대괄호 요약 | 스킬 본문 (SKILL.md가 로드되는 메시지) |
| | 도구 호출/결과 상세 내용 |
| | Claude의 내부 계획 ("파일을 읽겠습니다" 등) |
| | 에러 메시지, `/clear` 등 명령어 |
| | `<command-name>`, `<tool-result>` 등 XML 태그 |

#### 도구 동작 요약 방식

도구 사용은 대화 흐름에 필요한 경우만 대괄호로 요약합니다:

```
[SKILL.md와 _meta-profile.md를 읽음]
[세션 기록 저장: 2026-02-14-frame-health.md]
[최근 세션 2개 읽음]
```

#### 연속 발화 병합

같은 화자의 연속 메시지가 하나의 생각이면 병합합니다. 별개의 맥락이면 `---`로 구분합니다.

#### 참고 사항

- 대화 원문은 **사용자 확인 없이 자동 저장**합니다 (요약 기록과 달리)
- 이미 gold standard 수준으로 정리된 원문이 있으면 중복 저장하지 않습니다
- 같은 세션에서 이어진 대화는 하나의 파일로 저장합니다

### 2. meta-profile.md 업데이트 제안
대화에서 나온 내용을 바탕으로 메타 프로필 업데이트를 제안합니다:

| 섹션 | 확인할 것 | 행동 |
|------|-----------|------|
| 1. 지금 나의 프레임 | 기존 이해가 바뀜 | 해당 항목 수정 |
| 2. 프레임이 바뀐 순간들 | 기존 프레임이 깨짐 | 새 항목 추가 (사용자의 말을 제목으로) |
| 3. 아직 안 깨진 것 | 확인만 되고 도전 안 된 패턴 | 추가. 깨졌으면 섹션 2로 이동 |
| 4. 지금 열려있는 긴장 | 미해결 질문 발생 | 추가. 해소됐으면 제거 |
| 5. 세션 로그 | 매 세션 | 출발→착지 한 줄 추가 |

**사용자 확인 후** 업데이트합니다. 자동 업데이트하지 않습니다.
